{"ast":null,"code":"var MapboxDraw = require('@mapbox/mapbox-gl-draw');\nvar createSupplementaryPoints = require('../utils/create_supplementary_points');\nvar moveFeatures = require('../utils/move_features');\nvar Constants = require('../utils/constants');\nvar constrainFeatureMovement = require(\"../utils/constrain_feature_movement\");\nvar distance = require('@turf/distance').default;\nvar turfHelpers = require('@turf/helpers');\nvar circle = require('@turf/circle').default;\nvar createSupplementaryPointsForCircle = require('../utils/create_supplementary_points_circle');\nvar DirectModeOverride = MapboxDraw.modes.direct_select;\nDirectModeOverride.dragFeature = function (state, e, delta) {\n  moveFeatures(this.getSelected(), delta);\n  this.getSelected().filter(function (feature) {\n    return feature.properties.isCircle;\n  }).map(function (circle) {\n    return circle.properties.center;\n  }).forEach(function (center) {\n    center[0] += delta.lng;\n    center[1] += delta.lat;\n  });\n  state.dragMoveLocation = e.lngLat;\n};\nDirectModeOverride.dragVertex = function (state, e, delta) {\n  if (state.feature.properties.isCircle) {\n    var center = state.feature.properties.center;\n    var movedVertex = [e.lngLat.lng, e.lngLat.lat];\n    var radius = distance(turfHelpers.point(center), turfHelpers.point(movedVertex), {\n      units: 'kilometers'\n    });\n    var circleFeature = circle(center, radius);\n    state.feature.incomingCoords(circleFeature.geometry.coordinates);\n    state.feature.properties.radiusInKm = radius;\n  } else {\n    var selectedCoords = state.selectedCoordPaths.map(function (coord_path) {\n      return state.feature.getCoordinate(coord_path);\n    });\n    var selectedCoordPoints = selectedCoords.map(function (coords) {\n      return {\n        type: Constants.geojsonTypes.FEATURE,\n        properties: {},\n        geometry: {\n          type: Constants.geojsonTypes.POINT,\n          coordinates: coords\n        }\n      };\n    });\n    var constrainedDelta = constrainFeatureMovement(selectedCoordPoints, delta);\n    for (var i = 0; i < selectedCoords.length; i++) {\n      var coord = selectedCoords[i];\n      state.feature.updateCoordinate(state.selectedCoordPaths[i], coord[0] + constrainedDelta.lng, coord[1] + constrainedDelta.lat);\n    }\n  }\n};\nDirectModeOverride.toDisplayFeatures = function (state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = Constants.activeStates.ACTIVE;\n    push(geojson);\n    var supplementaryPoints = geojson.properties.user_isCircle ? createSupplementaryPointsForCircle(geojson) : createSupplementaryPoints(geojson, {\n      map: this.map,\n      midpoints: true,\n      selectedPaths: state.selectedCoordPaths\n    });\n    supplementaryPoints.forEach(push);\n  } else {\n    geojson.properties.active = Constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n  this.fireActionable(state);\n};\nmodule.exports = DirectModeOverride;","map":{"version":3,"names":["MapboxDraw","require","createSupplementaryPoints","moveFeatures","Constants","constrainFeatureMovement","distance","default","turfHelpers","circle","createSupplementaryPointsForCircle","DirectModeOverride","modes","direct_select","dragFeature","state","e","delta","getSelected","filter","feature","properties","isCircle","map","center","forEach","lng","lat","dragMoveLocation","lngLat","dragVertex","movedVertex","radius","point","units","circleFeature","incomingCoords","geometry","coordinates","radiusInKm","selectedCoords","selectedCoordPaths","coord_path","getCoordinate","selectedCoordPoints","coords","type","geojsonTypes","FEATURE","POINT","constrainedDelta","i","length","coord","updateCoordinate","toDisplayFeatures","geojson","push","featureId","id","active","activeStates","ACTIVE","supplementaryPoints","user_isCircle","midpoints","selectedPaths","INACTIVE","fireActionable","module","exports"],"sources":["/Users/carterbrewer/Downloads/trucker_app-main/node_modules/maplibre-gl-draw-circle/lib/modes/DirectModeOverride.js"],"sourcesContent":["const MapboxDraw = require('@mapbox/mapbox-gl-draw');\nconst createSupplementaryPoints = require('../utils/create_supplementary_points');\nconst moveFeatures = require('../utils/move_features');\nconst Constants = require('../utils/constants');\nconst constrainFeatureMovement = require(\"../utils/constrain_feature_movement\");\nconst distance = require('@turf/distance').default;\nconst turfHelpers = require('@turf/helpers');\nconst circle = require('@turf/circle').default;\nconst createSupplementaryPointsForCircle = require('../utils/create_supplementary_points_circle');\n\n\nconst DirectModeOverride = MapboxDraw.modes.direct_select;\n\nDirectModeOverride.dragFeature = function(state, e, delta) {\n  moveFeatures(this.getSelected(), delta);\n  this.getSelected()\n    .filter(feature => feature.properties.isCircle)\n    .map(circle => circle.properties.center)\n    .forEach(center => {\n      center[0] += delta.lng;\n      center[1] += delta.lat;\n    });\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectModeOverride.dragVertex = function(state, e, delta) {\n  if (state.feature.properties.isCircle) {\n    const center = state.feature.properties.center;\n    const movedVertex = [e.lngLat.lng, e.lngLat.lat];\n    const radius = distance(turfHelpers.point(center), turfHelpers.point(movedVertex), {units: 'kilometers'});\n    const circleFeature = circle(center, radius);\n    state.feature.incomingCoords(circleFeature.geometry.coordinates);\n    state.feature.properties.radiusInKm = radius;\n  } else {\n    const selectedCoords = state.selectedCoordPaths.map(coord_path => state.feature.getCoordinate(coord_path));\n    const selectedCoordPoints = selectedCoords.map(coords => ({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: {},\n      geometry: {\n        type: Constants.geojsonTypes.POINT,\n        coordinates: coords\n      }\n    }));\n\n    const constrainedDelta = constrainFeatureMovement(selectedCoordPoints, delta);\n    for (let i = 0; i < selectedCoords.length; i++) {\n      const coord = selectedCoords[i];\n      state.feature.updateCoordinate(state.selectedCoordPaths[i], coord[0] + constrainedDelta.lng, coord[1] + constrainedDelta.lat);\n    }\n  }\n};\n\nDirectModeOverride.toDisplayFeatures = function (state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = Constants.activeStates.ACTIVE;\n    push(geojson);\n    const supplementaryPoints = geojson.properties.user_isCircle ? createSupplementaryPointsForCircle(geojson)\n      : createSupplementaryPoints(geojson, {\n        map: this.map,\n        midpoints: true,\n        selectedPaths: state.selectedCoordPaths\n      });\n    supplementaryPoints.forEach(push);\n  } else {\n    geojson.properties.active = Constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n  this.fireActionable(state);\n\n}\n\nmodule.exports = DirectModeOverride;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}